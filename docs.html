<html>
<body>

<center>
<h2>mac dylib bundler</h2>
</center>

<h3>About</h3>
<blockquote>
Mac OS X intoduced an innovative and very useful way to package applications : app bundles.
While their design has all that is needed to ease distribution of resources and frameworks, it
seems like dynamic libraries (.dylib) are very complicated to distribute. Sure, applications developped
specifically for OS X won't make use of them, however applications ported from Linux or other Unices may have
dependencies that will only compile as dylibs. By default, there exists no mecanism to bundle them but some command-line utilities provided by Apple - however it turns out that for a single program it is often necessary to issue dozens of commands! This often leads each porter to develop their own "home solution" wich are often hacky, poorly portable and/or unoptimal.<br/><br/>

<b>dylibbundler</b> is a small command-line programs that aims to make bundling .dylibs as easy as possible.
It allows you to conveniently define a list of libraries in a config file and then prepares them all and your executable with
a single command on the teminal. It allows for setting dynamic library identification rules so that config files can cope
with different versions of a library.
<br/><br/>
It usually involves 2 actions :
<ul>
<li/>Creating a directory (by default called <i>libs</i>) that can be placed inside the <i>Contents</i> folder of the app bundle.
<li/>Fixing the executable file so that it is aware of the new location of its dependencies.
</ul>
</blockquote>

<h3>Installation</h3>
<blockquote>
In the terminal, cd to the main directory of dylibbundler and type "make". You can install with "sudo make install".
</blockquote>

<h3>Feedback / Contact </h3>
<blockquote>
You can contact me at <A href="mailto:auria@users.sourceforge.net">auria@users.sourceforge.net</A> or on the <A href="http://sourceforge.net/projects/macdylibbundler">sourceforge project page</A>
</blockquote>

<!----------------------------------------------------- Terminal Flags --------------------------------------------------------->

<h3>Using dylibbundler on the terminal</h3>
<blockquote>
Here is a list of flags you can pass to dylibbundler on the terminal.<br/><br/>

-h, --help
<blockquote>displays a summary of options</blockquote>

-x, --fix-executable (executable file)
<blockquote>fixes executable file, where (executable file) is the path to the executable.
(By default, the executable will remember the dylibs it linked again were in e.g. /usr/local/lib/
and will expect to find them there. This command will tell it the new location of bundled dylibs)</blockquote>

-l, --fix-libraries
<blockquote>Copies libaries to a local directory, fixes their iternal name so that they are aware of their new location,
fixes dependencies where bundled libraries depend on each other. If this option is not passed, no libraries will be prepared for distribution.</blockquote>

-c, --config (config file)
<blockquote>Tells dylibbundler where to find the config file (by default, it searches for <i>dylibbundler.config</i> in current directory)</blockquote>

-d, --dest-folder (directory)
<blockquote>Sets the name of the directory in wich distribution-ready dylibs will be placed. (Default is <i>./libs</i>)</blockquote>

-of, --overwrite-files
<blockquote>When copying libraries to dest-folder, allow overwriting files when one with the same name already exists.</blockquote>

-od, --overwrite-dir
<blockquote>If dest-folder already exists, completely erase its current content before adding anything to it.</blockquote>

-cd, --create-dir
<blockquote>If dest-folder does not exist, create it.</blockquote>

-p, --install-path (libraries install path)
<blockquote>Tells the installation path of libraries inside bundle. (Default is <i>@executable_path/../libs/</i>,
which points to a directory named <i>libs</i> inside the <i>Contents</i> folder of the bundle.)
</blockquote>

A command may look like
<blockquote>
dylibbundler -cd -od -l -x ./HelloWorld.app/Contents/MacOS/helloworld -d ./HelloWorld.app/Contents/libs/
</blockquote>

</blockquote>
<!--------------------------------------------------------------- Config file ------------------------------------------------->

<h3>Writing config files</h3>
<blockquote>
Dylibbundler uses XML config files to resolve dependencies. By default, it searches for a file named <i>dylibbundler.config</i>.
<br/>There are 2 ways to specify libraries:
<ul>
<li/><b>File lists</b> This simply involves writing a list of library files, including their symlinks, by entry.
It is great for targetting specific files, however since library names change with each version you will need to update the config file rather often.
Also, it requires that veryone that will use dylibbundler with this config file must all use the same versions of the dependencies in the same prefix;
otherwise it will be necessary that everyone writes their own config file that matches what is installed on their computer.
<li/><b>Search criteria</b>This involves setting some criteria to identify libraries from their names. It is quicker to set-up, and also works
with many versions of the same lib (as long as they keep the same naming conventions for their lib files and only the number changes).
However if you have multiple versions of the same library installed on your computer at the same time in the same prefix,
it may not know wich one to use and you'll need to edit the config file to explicitely exclude one or more.
</ul>

If you wish to use library file search from criteria, your config file must contain a &lt;search_path&gt; tag with library location(s) in it. Multiple paths
may be included, seperated with colons (:).
<blockquote> &lt;search_path&gt;/usr/local/lib/:/usr/lib/&lt;search_path/&gt; </blockquote>

You must create one &lt;library/&gt; tag for each library you need to include in your app. (Hint : <i>otool -L (file)</i> will allow
you to see on what libs (file) depends. Unless you installed things in non-standard paths, usually those in /usr/lib/ were pre-installed
with OS X). This tag must have an attribute <i>name</i> that will be used to identify it and name its file. Usually you will want to use the
form "lib<i>name</i>" without any version in it. If this library depends on any library that does not come with OS X, you will need to
bundle it too by creating an entry for it. You can specify that the current library depends on another entry of the config file with the
attribute <i>dependencies</i>. The content of <i>dependencies</i> is the <i>name</i> attribute of the entries this library depends
upon, and you can include many dependencies by seperating them with colons (:). You need to specify all correct inter-library
dependencies betweem libraries, otherwise your program will not work on other computers than yours (once again : use the otool tip.)

<blockquote> &lt;library name="libSDL_image" dependencies="libjpeg:libpng" ... &gt; </blockquote> <i>You will need
entries named "libjpeg" and "libpng"</i>

If you wish to use file lists, you will use 3 attributes : <i>path</i>, <i>file</i>, <i>symlinks</i>.
<i>path</i> is here the library if located (e.g. /usr/local/lib/), <i>file</i> is the name of the library file, <i>symlinks</i> is a
list sepered with colons (:) of all symlinks to this library file that exist.

<blockquote> &lt;library name="libfoo"  path="/usr/local/lib/" file="libfoo-1.2.12.0.dylib" symlinks="libfoo.dylib:libfoo.1.dylib:libfoo.1.2.dylib"/&gt; </blockquote>

If you would rather use file search with criteria you will use (in addition to the &lt;search_path&gt; tag described above) 
<i>starts_with</i>, <i>ends_with</i>, <i>contains</i>, <i>doesnt_contain</i>. <i>doesnt_contain</i>
may contain multiple keywords seperated with colons (:). It will automatically select all
library files and symlinks. Be careful that your description is precise enough so that it does
not match libraries with similar names.

<blockquote> &lt;library name="libfoo"  starts_with="libfoo" ends_with=".dylib" doesnt_contain="foobar:food"/&gt;
<i>would select libfoo files but not libfoobar nor libfood</i></blockquote>


</blockquote>


<br/><br/><br/><br/><br/><br/><br/><br/>

</body>
</html>